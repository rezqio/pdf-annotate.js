{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d4e595746ee00df63975","webpack:///./index.js","webpack:///./src/PDFJSAnnotate.js","webpack:///./src/adapter/StoreAdapter.js","webpack:///./src/utils/abstractFunction.js","webpack:///./src/UI/event.js","webpack:///./~/events/events.js","webpack:///./src/UI/utils.js","webpack:///./~/create-stylesheet/index.js","webpack:///./src/adapter/LocalStoreAdapter.js","webpack:///./src/utils/uuid.js","webpack:///./src/render/index.js","webpack:///./src/render/appendChild.js","webpack:///./~/object-assign/index.js","webpack:///./src/render/renderLine.js","webpack:///./src/utils/setAttributes.js","webpack:///./src/utils/normalizeColor.js","webpack:///./src/render/renderPath.js","webpack:///./src/render/renderPoint.js","webpack:///./src/render/renderRect.js","webpack:///./src/render/renderText.js","webpack:///./src/a11y/renderScreenReaderHints.js","webpack:///./src/a11y/insertScreenReaderHint.js","webpack:///./src/a11y/createScreenReaderOnly.js","webpack:///./src/a11y/insertElementWithinChildren.js","webpack:///./src/a11y/insertElementWithinElement.js","webpack:///./src/a11y/renderScreenReaderComments.js","webpack:///./src/a11y/insertScreenReaderComment.js","webpack:///./src/a11y/initEventHandlers.js","webpack:///./src/UI/index.js","webpack:///./src/UI/edit.js","webpack:///./src/UI/pen.js","webpack:///./src/UI/point.js","webpack:///./src/UI/rect.js","webpack:///./src/UI/text.js","webpack:///./src/UI/page.js"],"names":["PDFJSAnnotate","StoreAdapter","LocalStoreAdapter","__storeAdapter","getStoreAdapter","setStoreAdapter","adapter","UI","render","getAnnotations","documentId","pageNumber","arguments","definition","Object","keys","forEach","key","annotationId","annotation","content","commentId","__getAnnotations","fn","then","annotations","a","__addAnnotation","addAnnotation","__editAnnotation","editAnnotation","__deleteAnnotation","deleteAnnotation","success","__addComment","addComment","comment","__deleteComment","deleteComment","abstractFunction","name","Error","fireEvent","addEventListener","removeEventListener","emitter","EventEmitter","clickNode","document","handleDocumentClick","e","clientX","clientY","target","emit","on","removeListener","findSVGContainer","findSVGAtPoint","findAnnotationAtPoint","pointIntersectsRect","getOffsetAnnotationRect","getAnnotationRect","scaleUp","scaleDown","getScroll","getOffset","disableUserSelect","enableUserSelect","getMetadata","BORDER_COLOR","HIT_TEST_OFFSET","userSelectStyleSheet","body","setAttribute","node","parentNode","nodeName","toUpperCase","getAttribute","x","y","elements","querySelectorAll","i","l","length","el","rect","getBoundingClientRect","svg","pointerEvents","getElementsByClassName","style","xTest","yTest","candidate","elementFromPoint","type","toLowerCase","top","bottom","left","right","offsetLeft","offsetTop","h","w","LINE_OFFSET","minX","maxX","minY","maxY","replace","split","splice","p","s","map","parseInt","height","width","result","includes","viewport","scale","scrollTop","scrollLeft","head","appendChild","removeChild","JSON","parse","Promise","resolve","reject","filter","page","class","getAnnotation","findAnnotation","uuid","push","updateAnnotations","index","getComments","localStorage","getItem","setItem","stringify","REGEXP","PATTERN","replacement","c","r","Math","random","v","toString","data","innerHTML","removeAttribute","Array","isArray","isFirefox","test","navigator","userAgent","getTranslation","rotation","transform","trans","path","querySelector","n","child","renderLine","group","createElementNS","stroke","color","strokeWidth","rectangles","line","x1","y1","x2","y2","setAttributes","UPPER_REGEX","BLACKLIST","keyCase","indexOf","match","attributes","normalizeColor","REGEX_HASHLESS_HEX","renderPath","d","lines","p1","p2","join","fill","renderPoint","SIZE","D","outerSVG","innerSVG","viewBox","renderRect","fillOpacity","createRect","renderText","text","size","fontSize","renderScreenReaderHints","SORT_TYPES","sortBy","sort","sortByPoint","b","sortByRectPoint","sortByLinePoint","lineA","lineB","insertScreenReaderHint","COMMENT_TYPES","num","rects","first","last","createScreenReaderOnly","createElement","createTextNode","position","overflow","insertElementWithinChildren","nodes","insertBefore","textLayer","textRect","insertElementWithinElement","OFFSET_ADJUST","max","textLayerElementFromPoint","temp","cloneNode","tail","unshift","pop","outerHTML","renderScreenReaderComments","comments","promise","getElementById","list","insertScreenReaderComment","item","initEventHandlers","reorderAnnotationsByType","removeAnnotation","insertComment","removeComment","removeElementById","elementId","disableEdit","enableEdit","disablePen","enablePen","setPen","disablePoint","enablePoint","disableRect","enableRect","disableText","enableText","setText","createPage","renderPage","_enabled","isDragging","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","OVERLAY_BORDER_SIZE","createEditOverlay","destroyEditOverlay","anchor","id","styleLeft","styleTop","boxSizing","border","borderRadius","cursor","background","padding","textAlign","textDecoration","handleDocumentKeyup","handleDocumentMousedown","borderColor","boxShadow","display","handleDocumentMousemove","handleDocumentMouseup","keyCode","offsetHeight","offsetWidth","getDelta","propX","propY","calcDelta","deltaX","deltaY","t","modelY","viewY","modelX","viewX","originX","originY","handleAnnotationClick","_penSize","_penColor","savePoint","point","penSize","penColor","input","handleInputBlur","handleInputKeyup","focus","closeInput","value","trim","assign","_type","clearSelection","window","getSelection","removeAllRanges","addRange","createRange","empty","getSelectionRects","selection","range","getRangeAt","getClientRects","saveRect","boundingRect","offset","_textSize","_textColor","saveText","textSize","textColor","PAGE_TEMPLATE","children","canvas","mozOpaque","renderOptions","pdfDocument","rotate","all","getPage","pdfPage","canvasContext","getContext","alpha","getViewport","scalePage","getTextContent","normalizeWhitespace","textContent","textLayerFactory","PDFJS","DefaultTextLayerFactory","textLayerBuilder","createTextLayerBuilder","setTextContent","setTimeout","context","wrapper","outputScale","getOutputScale","scaled","sx","sy","sfx","approximateFraction","sfy","visibility","roundToDivide","floor","xinv","limit","x_","q","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","div","round"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;SCvRgB6C,gB,GAAAA,gB;SAqBAC,c,GAAAA,c;SAuBAC,qB,GAAAA,qB;SAoDAC,mB,GAAAA,mB;SAUAC,uB,GAAAA,uB;SAiBAC,iB,GAAAA,iB;SA8FAC,O,GAAAA,O;SAkBAC,S,GAAAA,S;SAiBAC,S,GAAAA,S;SAoBAC,S,GAAAA,S;SAkBAC,iB,GAAAA,iB;SAUAC,gB,GAAA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","file":"dist/pdf-annotate.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d4e595746ee00df63975\n **/","import PDFJSAnnotate from './src/PDFJSAnnotate';\n\nexport default PDFJSAnnotate;\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","import StoreAdapter from './adapter/StoreAdapter';\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\nimport render from './render';\nimport UI from './UI';\n\nexport default {\n  /**\n   * Abstract class that needs to be defined so PDFJSAnnotate\n   * knows how to communicate with your server.\n   */\n  StoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\n   */\n  LocalStoreAdapter,\n\n  /**\n   * Abstract instance of StoreAdapter\n   */\n  __storeAdapter: new StoreAdapter(),\n\n  /**\n   * Getter for the underlying StoreAdapter property\n   *\n   * @return {StoreAdapter}\n   */\n  getStoreAdapter() {\n    return this.__storeAdapter;\n  },\n\n  /**\n   * Setter for the underlying StoreAdapter property\n   *\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n   */\n  setStoreAdapter(adapter) {\n    // TODO this throws an error when bundled\n    // if (!(adapter instanceof StoreAdapter)) {\n    //   throw new Error('adapter must be an instance of StoreAdapter');\n    // }\n\n    this.__storeAdapter = adapter;\n  },\n\n  /**\n   * UI is a helper for instrumenting UI interactions for creating,\n   * editing, and deleting annotations in the browser.\n   */\n  UI,\n\n  /**\n   * Render the annotations for a page in the PDF Document\n   *\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n   * @param {PageViewport} viewport The PDFPage.getViewport data\n   * @param {Object} data The StoreAdapter.getAnnotations data\n   * @return {Promise}\n   */\n  render,\n\n  /**\n   * Convenience method for getting annotation data\n   *\n   * @alias StoreAdapter.getAnnotations\n   * @param {String} documentId The ID of the document\n   * @param {String} pageNumber The page number\n   * @return {Promise}\n   */\n  getAnnotations(documentId, pageNumber) {\n    return this.getStoreAdapter().getAnnotations(...arguments);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PDFJSAnnotate.js\n **/","import abstractFunction from '../utils/abstractFunction';\nimport { fireEvent } from '../UI/event';\n\n// Adapter should never be invoked publicly\nexport default class StoreAdapter {\n  /**\n   * Create a new StoreAdapter instance\n   *\n   * @param {Object} [definition] The definition to use for overriding abstract methods\n   */\n  constructor(definition = {}) {\n    // Copy each function from definition if it is a function we know about\n    Object.keys(definition).forEach((key) => {\n      if (typeof definition[key] === 'function' &&\n          typeof this[key] === 'function') {\n        this[key] = definition[key];\n      }\n    });\n  }\n\n  /**\n   * Get all the annotations for a given document and page number.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @param {Number} pageNumber The number of the page the annotations belong to\n   * @return {Promise}\n   */\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\n  get getAnnotations() { return this.__getAnnotations; }\n  set getAnnotations(fn) {\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n      return fn(...arguments).then((annotations) => {\n        // TODO may be best to have this happen on the server\n        if (annotations.annotations) {\n          annotations.annotations.forEach((a) => {\n            a.documentId = documentId;\n          });\n        }\n        return annotations;\n      });\n    };\n  }\n\n  /**\n   * Get the definition for a specific annotation.\n   *\n   * @param {String} documentId The ID for the document the annotation belongs to\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\n\n  /**\n   * Add an annotation\n   *\n   * @param {String} documentId The ID for the document to add the annotation to\n   * @param {String} pageNumber The page number to add the annotation to\n   * @param {Object} annotation The definition for the new annotation\n   * @return {Promise}\n   */\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\n  get addAnnotation() { return this.__addAnnotation; }\n  set addAnnotation(fn) {\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Edit an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} pageNumber the page number of the annotation\n   * @param {Object} annotation The definition of the modified annotation\n   * @return {Promise}\n   */\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\n  get editAnnotation() { return this.__editAnnotation; }\n  set editAnnotation(fn) {\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Delete an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\n  get deleteAnnotation() { return this.__deleteAnnotation; }\n  set deleteAnnotation(fn) {\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('annotation:delete', documentId, annotationId);\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Get all the comments for an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\n\n  /**\n   * Add a new comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @param {Object} content The definition of the comment\n   * @return {Promise}\n   */\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\n  get addComment() { return this.__addComment; }\n  set addComment(fn) {\n    this.__addComment = function addComment(documentId, annotationId, content) {\n      return fn(...arguments).then((comment) => {\n        fireEvent('comment:add', documentId, annotationId, comment);\n        return comment;\n      });\n    };\n  }\n\n  /**\n   * Delete a comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} commentId The ID for the comment\n   * @return {Promise}\n   */\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\n  get deleteComment() { return this.__deleteComment; }\n  set deleteComment(fn) {\n    this.__deleteComment = function deleteComment(documentId, commentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('comment:delete', documentId, commentId);\n        }\n        return success;\n      });\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/adapter/StoreAdapter.js\n **/","/**\n * Throw an Error for an abstract function that hasn't been implemented.\n *\n * @param {String} name The name of the abstract function\n */\nexport default function abstractFunction(name) {\n  throw new Error(name + ' is not implemented');\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/abstractFunction.js\n **/","import EventEmitter from 'events';\nimport {\n  findAnnotationAtPoint,\n  findSVGAtPoint\n} from './utils';\n\nconst emitter = new EventEmitter;\n\nlet clickNode;\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event to be handled\n */\ndocument.addEventListener('click', function handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n\n  // Emit annotation:blur if clickNode is no longer clicked\n  if (clickNode && clickNode !== target) {\n    emitter.emit('annotation:blur', clickNode);\n  }\n\n  // Emit annotation:click if target was clicked\n  if (target) {\n    emitter.emit('annotation:click', target);\n  }\n\n  clickNode = target;\n});\n\n// let mouseOverNode;\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n//\n//   // Emit annotation:mouseout if target was mouseout'd\n//   if (mouseOverNode && !target) {\n//     emitter.emit('annotation:mouseout', mouseOverNode);\n//   }\n//\n//   // Emit annotation:mouseover if target was mouseover'd\n//   if (target && mouseOverNode !== target) {\n//     emitter.emit('annotation:mouseover', target);\n//   }\n//\n//   mouseOverNode = target;\n// });\n\nexport function fireEvent() { emitter.emit(...arguments); };\nexport function addEventListener() { emitter.on(...arguments); };\nexport function removeEventListener() { emitter.removeListener(...arguments); };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/event.js\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/events/events.js\n ** module id = 5\n ** module chunks = 0\n **/","import createStyleSheet from 'create-stylesheet';\n\nexport const BORDER_COLOR = '#00BFFF';\n\nexport const HIT_TEST_OFFSET = 10;\n\nconst userSelectStyleSheet = createStyleSheet({\n  body: {\n    '-webkit-user-select': 'none',\n       '-moz-user-select': 'none',\n        '-ms-user-select': 'none',\n            'user-select': 'none'\n  }\n});\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\n/**\n * Find the SVGElement that contains all the annotations for a page\n *\n * @param {Element} node An annotation within that container\n * @return {SVGElement} The container SVG or null if it can't be found\n */\nexport function findSVGContainer(node) {\n  let parentNode = node;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG' &&\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n      return parentNode;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an SVGElement container at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {SVGElement} The container SVG or null if one can't be found\n */\nexport function findSVGAtPoint(x, y) {\n  let elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\n  for (let i=0, l=elements.length; i<l; i++) {\n    let el = elements[i];\n    let rect = el.getBoundingClientRect();\n\n    if (pointIntersectsRect(x, y, rect)) {\n\n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an Element that represents an annotation at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {Element} The annotation element or null if one can't be found\n */\nexport function findAnnotationAtPoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) { return; }\n\n  // temporarily disable pointer events on textLayer\n  const pointerEvents = document.getElementsByClassName('textLayer')[0].style.pointerEvents;\n  document.getElementsByClassName('textLayer')[0].style.pointerEvents = \"none\";\n\n  // Find rectangle/lines annotations\n  for (let xTest = x - HIT_TEST_OFFSET; xTest <= x + HIT_TEST_OFFSET; xTest++) {\n    for (let yTest = y - HIT_TEST_OFFSET; yTest <= y + HIT_TEST_OFFSET; yTest++) {\n      const candidate = document.elementFromPoint(xTest, yTest);\n      if (!candidate) continue;\n      const type = candidate.getAttribute('data-pdf-annotate-type');\n      if (!type) continue;\n      if (candidate.nodeName.toLowerCase() === 'rect' ||\n          candidate.nodeName.toLowerCase() === 'path') {\n        document.getElementsByClassName('textLayer')[0].style.pointerEvents = pointerEvents;\n        return candidate;\n      }\n    }\n  }\n  document.getElementsByClassName('textLayer')[0].style.pointerEvents = pointerEvents;\n\n  let elements = svg.querySelectorAll('[data-pdf-annotate-type]');\n\n  // Find a target element within SVG\n  for (let i=0, l=elements.length; i<l; i++) {\n    let el = elements[i];\n\n    // Skip over rectangle and lines\n    if (el.nodeName.toLowerCase() === 'rect' ||\n        el.nodeName.toLowerCase() === 'path') {\n      continue;\n    }\n\n    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {   \n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Determine if a point intersects a rect\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n * @return {Boolean} True if a collision occurs, otherwise false\n */\nexport function pointIntersectsRect(x, y, rect) {\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n}\n\n/**\n * Get the rect of an annotation element accounting for offset.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getOffsetAnnotationRect(el) {\n  let rect = getAnnotationRect(el);\n  let { offsetLeft, offsetTop } = getOffset(el);\n  return {\n    top: rect.top + offsetTop,\n    left: rect.left + offsetLeft,\n    right: rect.right + offsetLeft,\n    bottom: rect.bottom + offsetTop\n  };\n}\n\n/**\n * Get the rect of an annotation element.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getAnnotationRect(el) {\n  let h = 0, w = 0, x = 0, y = 0;\n  let rect = el.getBoundingClientRect();\n  // TODO this should be calculated somehow\n  const LINE_OFFSET = 16;\n\n  switch (el.nodeName.toLowerCase()) {\n    case 'path':\n    let minX, maxX, minY, maxY;\n\n    el.getAttribute('d').replace(/Z/, '').split('M').splice(1).forEach((p) => {\n      var s = p.split(' ').map(i => parseInt(i, 10));\n\n      if (typeof minX === 'undefined' || s[0] < minX) { minX = s[0]; }\n      if (typeof maxX === 'undefined' || s[2] > maxX) { maxX = s[2]; }\n      if (typeof minY === 'undefined' || s[1] < minY) { minY = s[1]; }\n      if (typeof maxY === 'undefined' || s[3] > maxY) { maxY = s[3]; }\n    });\n\n    h = maxY - minY;\n    w = maxX - minX;\n    x = minX;\n    y = minY;\n    break;\n\n    case 'line':\n    h = parseInt(el.getAttribute('y2'), 10) - parseInt(el.getAttribute('y1'), 10);\n    w = parseInt(el.getAttribute('x2'), 10) - parseInt(el.getAttribute('x1'), 10);\n    x = parseInt(el.getAttribute('x1'), 10);\n    y = parseInt(el.getAttribute('y1'), 10);\n\n    if (h === 0) {\n      h += LINE_OFFSET;\n      y -= (LINE_OFFSET / 2);\n    }\n    break;\n\n    case 'text':\n    h = rect.height;\n    w = rect.width;\n    x = parseInt(el.getAttribute('x'), 10);\n    y = parseInt(el.getAttribute('y'), 10) - h;\n    break;\n\n    case 'g':\n    let { offsetLeft, offsetTop } = getOffset(el);\n    h = rect.height;\n    w = rect.width;\n    x = rect.left - offsetLeft;\n    y = rect.top - offsetTop;\n\n    if (el.getAttribute('data-pdf-annotate-type') === 'strikeout') {\n      h += LINE_OFFSET;\n      y -= (LINE_OFFSET / 2);\n    }\n    break;\n\n    case 'rect':\n    case 'svg':\n    h = parseInt(el.getAttribute('height'), 10);\n    w = parseInt(el.getAttribute('width'), 10);\n    x = parseInt(el.getAttribute('x'), 10);\n    y = parseInt(el.getAttribute('y'), 10);\n    break;\n  }\n\n  // Result provides same properties as getBoundingClientRect\n  let result = {\n    top: y,\n    left: x,\n    width: w,\n    height: h,\n    right: x + w,\n    bottom: y + h\n  };\n\n  // For the case of nested SVG (point annotations) and grouped\n  // lines or rects no adjustment needs to be made for scale.\n  // I assume that the scale is already being handled\n  // natively by virtue of the `transform` attribute.\n  if (!['svg', 'g'].includes(el.nodeName.toLowerCase())) {\n    result = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\n  }\n\n  return result;\n}\n\n/**\n * Adjust scale from normalized scale (100%) to rendered scale.\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled up\n */\nexport function scaleUp(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] * viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Adjust scale from rendered scale to a normalized scale (100%).\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled down\n */\nexport function scaleDown(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] / viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Get the scroll position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the scroll position for\n * @return {Object} The scrollTop and scrollLeft position\n */\nexport function getScroll(el) {\n  let scrollTop = 0;\n  let scrollLeft = 0;\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    scrollTop += parentNode.scrollTop;\n    scrollLeft += parentNode.scrollLeft;\n  }\n\n  return { scrollTop, scrollLeft };\n}\n\n/**\n * Get the offset position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the offset position for\n * @return {Object} The offsetTop and offsetLeft position\n */\nexport function getOffset(el) {\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG') {\n      break;\n    }\n  }\n\n  let rect = parentNode.getBoundingClientRect();\n\n  return { offsetLeft: rect.left, offsetTop: rect.top };\n}\n\n/**\n * Disable user ability to select text on page\n */\nexport function disableUserSelect() {\n  if (!userSelectStyleSheet.parentNode) {\n    document.head.appendChild(userSelectStyleSheet);\n  }\n}\n\n\n/**\n * Enable user ability to select text on page\n */\nexport function enableUserSelect() {\n  if (userSelectStyleSheet.parentNode) {\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Get the metadata for a SVG container\n *\n * @param {SVGElement} svg The SVG container to get metadata for\n */\nexport function getMetadata(svg) {\n  return {\n    documentId: svg.getAttribute('data-pdf-annotate-document'),\n    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/utils.js\n **/","module.exports = function createStyleSheet(blocks) {\n  var style = document.createElement('style');\n  var text = Object.keys(blocks).map(function (selector) {\n    return processRuleSet(selector, blocks[selector]);\n  }).join('\\n');\n  \n  style.setAttribute('type', 'text/css');\n  style.appendChild(document.createTextNode(text));\n\n  return style;\n}\n\nfunction processRuleSet(selector, block) {\n  return selector + ' {\\n' + processDeclarationBlock(block) + '\\n}';\n}\n\nfunction processDeclarationBlock(block) {\n  return Object.keys(block).map(function (prop) {\n    return processDeclaration(prop, block[prop]);\n  }).join('\\n');\n}\n\nfunction processDeclaration(prop, value) {\n  if (!isNaN(value) && value != 0) {\n    value = value + 'px';\n  }\n\n  return hyphenate(prop) + ': ' + value + ';';\n}\n\nfunction hyphenate(prop) {\n  return prop.replace(/[A-Z]/g, function (match) {\n    return '-' + match.toLowerCase();\n  });\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/create-stylesheet/index.js\n ** module id = 7\n ** module chunks = 0\n **/","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage\n// This is ideal for testing, examples, and prototyping\nexport default class LocalStoreAdapter extends StoreAdapter {\n  constructor() {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      },\n\n      getAnnotation(documentId, annotationId) {\n        return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n      },\n\n      addAnnotation(documentId, pageNumber, annotation) {\n        return new Promise((resolve, reject) => {\n          annotation.class = 'Annotation';\n          annotation.uuid = uuid();\n          annotation.page = pageNumber;\n\n          let annotations = getAnnotations(documentId);\n          annotations.push(annotation);\n          updateAnnotations(documentId, annotations);\n\n          resolve(annotation);\n        });\n      },\n\n      editAnnotation(documentId, annotationId, annotation) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId);\n          annotations[findAnnotation(documentId, annotationId)] = annotation;\n          updateAnnotations(documentId, annotations);\n\n          resolve(annotation);\n        });\n      },\n\n      deleteAnnotation(documentId, annotationId) {\n        return new Promise((resolve, reject) => {\n          let index = findAnnotation(documentId, annotationId);\n          if (index > -1) {\n            let annotations = getAnnotations(documentId);\n            annotations.splice(index, 1);\n            updateAnnotations(documentId, annotations);\n          }\n\n          resolve(true);\n        });\n      },\n\n      getComments(documentId, annotationId) {\n        return new Promise((resolve, reject) => {\n          resolve(getAnnotations(documentId).filter((i) => {\n            return i.class === 'Comment' && i.annotation === annotationId;\n          }));\n        });\n      },\n\n      addComment(documentId, annotationId, content) {\n        return new Promise((resolve, reject) => {\n          let comment = {\n            class: 'Comment',\n            uuid: uuid(),\n            annotation: annotationId,\n            content: content\n          };\n\n          let annotations = getAnnotations(documentId);\n          annotations.push(comment);\n          updateAnnotations(documentId, annotations);\n\n          resolve(comment);\n        });\n      },\n\n      deleteComment(documentId, commentId) {\n        return new Promise((resolve, reject) => {\n          getAnnotations(documentId);\n          let index = -1;\n          let annotations = getAnnotations(documentId);\n          for (let i=0, l=annotations.length; i<l; i++) {\n            if (annotations[i].uuid === commentId) {\n              index = i;\n              break;\n            }\n          }\n\n          if (index > -1) {\n            annotations.splice(index, 1);\n            updateAnnotations(documentId, annotations);\n          }\n\n          resolve(true);\n        });\n      }\n    });\n  }\n}\n\nfunction getAnnotations(documentId) {\n  return JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, annotations) {\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\n}\n\nfunction findAnnotation(documentId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId);\n  for (let i=0, l=annotations.length; i<l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/adapter/LocalStoreAdapter.js\n **/","const REGEXP = /[xy]/g\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\nfunction replacement(c) {\n  let r = Math.random()*16|0;\n  let v = c == 'x' ? r : (r&0x3|0x8);\n  return v.toString(16);\n}\n\n/**\n * Generate a univierally unique identifier\n *\n * @return {String}\n */\nexport default function uuid() {\n  return PATTERN.replace(REGEXP, replacement);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/uuid.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from './appendChild';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n/**\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n *\n * @param {SVGElement} svg The SVG element to render the annotations to\n * @param {Object} viewport The page viewport data\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: SVGElement\n *    - rejected: Error\n */\nexport default function render(svg, viewport, data) {\n  return new Promise((resolve, reject) => {\n    // Reset the content of the SVG\n    svg.innerHTML = ''; \n    svg.setAttribute('data-pdf-annotate-container', true);\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n    svg.removeAttribute('data-pdf-annotate-document');\n    svg.removeAttribute('data-pdf-annotate-page');\n\n    // If there's no data nothing can be done\n    if (!data) {\n      return resolve(svg);\n    }\n\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n  \n    // Make sure annotations is an array\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n      return resolve(svg);\n    }\n\n    // Append annotation to svg\n    data.annotations.forEach((a) => {\n      appendChild(svg, a, viewport);\n    });\n\n    resolve(svg);\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/index.js\n **/","import objectAssign from 'object-assign';\nimport renderLine from './renderLine';\nimport renderPath from './renderPath';\nimport renderPoint from './renderPoint';\nimport renderRect from './renderRect';\nimport renderText from './renderText';\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\n/**\n * Get the x/y translation to be used for transforming the annotations\n * based on the rotation of the viewport.\n *\n * @param {Object} viewport The viewport data from the page\n * @return {Object}\n */\nfunction getTranslation(viewport) {\n  let x;\n  let y;\n\n  // Modulus 360 on the rotation so that we only\n  // have to worry about four possible values.\n  switch(viewport.rotation % 360) {\n    case 0:\n      x = y = 0;\n      break;\n    case 90:\n      x = 0;\n      y = (viewport.width / viewport.scale) * -1;\n      break;\n    case 180:\n      x = (viewport.width / viewport.scale) * -1;\n      y = (viewport.height / viewport.scale) * -1;\n      break;\n    case 270:\n      x = (viewport.height / viewport.scale) * -1;\n      y = 0;\n      break;\n  }\n\n  return { x, y };\n}\n\n/**\n * Transform the rotation and scale of a node using SVG's native transform attribute.\n *\n * @param {Node} node The node to be transformed\n * @param {Object} viewport The page's viewport data\n * @return {Node}\n */\nfunction transform(node, viewport) {\n  let trans = getTranslation(viewport);\n\n  // Let SVG natively transform the element\n  node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\n  \n  // Manually adjust x/y for nested SVG nodes\n  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\n    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\n    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\n\n    let x = parseInt(node.getAttribute('x', 10));\n    let y = parseInt(node.getAttribute('y', 10));\n    let width = parseInt(node.getAttribute('width'), 10);\n    let height = parseInt(node.getAttribute('height'), 10);\n    let path = node.querySelector('path');\n    let svg = path.parentNode;\n   \n    // Scale width/height\n    [node, svg, path, node.querySelector('rect')].forEach((n) => {\n      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\n      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\n    });\n\n    // Transform path but keep scale at 100% since it will be handled natively\n    transform(path, objectAssign({}, viewport, { scale: 1 }));\n    \n    switch(viewport.rotation % 360) {\n      case 90:\n        node.setAttribute('x', viewport.width - y - width);\n        node.setAttribute('y', x);\n        svg.setAttribute('x', 1);\n        svg.setAttribute('y', 0);\n        break;\n      case 180:\n        node.setAttribute('x', viewport.width - x - width);\n        node.setAttribute('y', viewport.height - y - height);\n        svg.setAttribute('y', 2);\n        break;\n      case 270:\n        node.setAttribute('x', y);\n        node.setAttribute('y', viewport.height - x - height);\n        svg.setAttribute('x', -1);\n        svg.setAttribute('y', 0);\n        break;\n    }\n  }\n\n  return node;\n}\n\n/**\n * Append an annotation as a child of an SVG.\n *\n * @param {SVGElement} svg The SVG element to append the annotation to\n * @param {Object} annotation The annotation definition to render and append\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was created and appended by this function\n */\nexport default function appendChild(svg, annotation, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n  }\n  \n  let child;\n  switch (annotation.type) {\n    case 'area':\n    case 'highlight':\n      child = renderRect(annotation);\n      break;\n    case 'strikeout':\n      child = renderLine(annotation);\n      break;\n    case 'point':\n      child = renderPoint(annotation);\n      break;\n    case 'textbox':\n      child = renderText(annotation);\n      break;\n    case 'drawing':\n      child = renderPath(annotation);\n      break;\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip appending/transforming if node doesn't exist.\n  if (child) {\n    // Set attributes\n    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\n    child.setAttribute('data-pdf-annotate-type', annotation.type);\n    child.setAttribute('aria-hidden', true);\n\n    svg.appendChild(transform(child, viewport));\n  }\n\n  return child;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/appendChild.js\n **/","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/object-assign/index.js\n ** module id = 12\n ** module chunks = 0\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGLineElements from an annotation definition.\n * This is used for anntations of type `strikeout`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement} A group of all lines to be rendered\n */\nexport default function renderLine(a) {\n  let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  setAttributes(group, {\n    stroke: normalizeColor(a.color || '#f00'),\n    strokeWidth: 1\n  });\n\n  a.rectangles.forEach((r) => {\n    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\n    setAttributes(line, {\n      x1: r.x,\n      y1: r.y,\n      x2: r.x + r.width,\n      y2: r.y,\n    });\n\n    group.appendChild(line);\n  });\n\n  return group;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderLine.js\n **/","const UPPER_REGEX = /[A-Z]/g;\n\n// Don't convert these attributes from camelCase to hyphenated-attributes\nconst BLACKLIST = [\n  'viewBox'\n];\n\nlet keyCase = (key) => {\n  if (BLACKLIST.indexOf(key) === -1) {\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\n  }\n  return key;\n}\n\n/**\n * Set attributes for a node from a map\n *\n * @param {Node} node The node to set attributes on\n * @param {Object} attributes The map of key/value pairs to use for attributes\n */\nexport default function setAttributes(node, attributes) {\n  Object.keys(attributes).forEach((key) => {\n    node.setAttribute(keyCase(key), attributes[key]);\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/setAttributes.js\n **/","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\n/**\n * Normalize a color value\n *\n * @param {String} color The color to normalize\n * @return {String}\n */\nexport default function normalizeColor(color) {\n  if (REGEX_HASHLESS_HEX.test(color)) {\n    color = `#${color}`;\n  }\n  return color;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/normalizeColor.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderPath(a) {\n  let d = [];\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n  \n  for (let i=0, l=a.lines.length; i<l; i++) {\n    var p1 = a.lines[i];\n    var p2 = a.lines[i+1];\n    if (p2) {\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n    }\n  }\n  \n  setAttributes(path, {\n    d: `${d.join(' ')}Z`,\n    stroke: normalizeColor(a.color || '#000'),\n    strokeWidth: a.width || 1,\n    fill: 'none'\n  });\n\n  return path;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderPath.js\n **/","import setAttributes from '../utils/setAttributes';\n\nconst SIZE = 25;\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\n/**\n * Create SVGElement from an annotation definition.\n * This is used for anntations of type `comment`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGElement} A svg to be rendered\n */\nexport default function renderPoint(a) {\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  setAttributes(outerSVG,  {\n    width: SIZE,\n    height: SIZE,\n    x: a.x,\n    y: a.y\n  });\n\n  setAttributes(innerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: 0,\n    y: (SIZE * 0.05) * -1,\n    viewBox: '0 0 1000 1000'\n  });\n\n  setAttributes(rect, {\n    width: SIZE,\n    height: SIZE,\n    stroke: '#000',\n    fill: '#ff0'\n  });\n\n  setAttributes(path, {\n    d: D,\n    strokeWidth: 50,\n    stroke: '#000',\n    fill: '#fff'\n  });\n\n  innerSVG.appendChild(path);\n  outerSVG.appendChild(rect);\n  outerSVG.appendChild(innerSVG);\n\n  return outerSVG;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderPoint.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGRectElements from an annotation definition.\n * This is used for anntations of type `area` and `highlight`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n */\nexport default function renderRect(a) {\n  if (a.type === 'highlight') {\n    let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    setAttributes(group, {\n      fill: normalizeColor(a.color || '#ff0'),\n      fillOpacity: 0.2\n    });\n    \n    a.rectangles.forEach((r) => {\n      group.appendChild(createRect(r));\n    });\n\n    return group;\n  } else {\n    let rect = createRect(a);\n    setAttributes(rect, {\n      stroke: normalizeColor(a.color || '#f00'),\n      fill: 'none'\n    });\n\n    return rect;\n  }\n}\n\nfunction createRect(r) {\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n  setAttributes(rect, {\n    x: r.x,\n    y: r.y,\n    width: r.width,\n    height: r.height\n  });\n\n  return rect;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderRect.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGTextElement from an annotation definition.\n * This is used for anntations of type `textbox`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGTextElement} A text to be rendered\n */\nexport default function renderText(a) {\n  var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n\n  setAttributes(text, {\n    x: a.x,\n    y: a.y + parseInt(a.size, 10),\n    fill: normalizeColor(a.color || '#000'),\n    fontSize: a.size\n  });\n  text.innerHTML = a.content;\n\n  return text;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderText.js\n **/","import insertScreenReaderHint from './insertScreenReaderHint';\nimport initEventHandlers from './initEventHandlers';\n\n// TODO This is not the right place for this to live\ninitEventHandlers();\n\n/**\n * Insert hints into the DOM for screen readers.\n *\n * @param {Array} annotations The annotations that hints are inserted for\n */\nexport default function renderScreenReaderHints(annotations) {\n  annotations = Array.isArray(annotations) ? annotations : [];\n\n  // Insert hints for each type\n  Object.keys(SORT_TYPES).forEach((type) => {\n    let sortBy = SORT_TYPES[type];\n    annotations\n      .filter((a) => a.type === type)\n      .sort(sortBy)\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\n  });\n}\n\n// Sort annotations first by y, then by x.\n// This allows hints to be injected in the order they appear,\n// which makes numbering them easier.\nfunction sortByPoint(a, b) {\n  if (a.y < b.y) {\n    return a.x - b.x;\n  } else {\n    return 1;\n  }\n}\n\n// Sort annotation by it's first rectangle\nfunction sortByRectPoint(a, b) {\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\n}\n\n// Sort annotation by it's first line\nfunction sortByLinePoint(a, b) {\n  let lineA = a.lines[0];\n  let lineB = b.lines[0];\n  return sortByPoint(\n    {x: lineA[0], y: lineA[1]},\n    {x: lineB[0], y: lineB[1]}\n  );\n}\n\n// Arrange supported types and associated sort methods\nconst SORT_TYPES = {\n  'highlight': sortByRectPoint,\n  'strikeout': sortByRectPoint,\n  'drawing': sortByLinePoint,\n  'textbox': sortByPoint,\n  'point': sortByPoint,\n  'area': sortByPoint\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/renderScreenReaderHints.js\n **/","import createScreenReaderOnly from './createScreenReaderOnly';\nimport insertElementWithinChildren from './insertElementWithinChildren';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport renderScreenReaderComments from './renderScreenReaderComments';\n\n// Annotation types that support comments\nconst COMMENT_TYPES = ['highlight', 'point', 'area'];\n\n/**\n * Insert a hint into the DOM for screen readers for a specific annotation.\n *\n * @param {Object} annotation The annotation to insert a hint for\n * @param {Number} num The number of the annotation out of all annotations of the same type\n */\nexport default function insertScreenReaderHint(annotation, num = 0) {\n  switch (annotation.type) {\n    case 'highlight':\n    case 'strikeout':\n      let rects = annotation.rectangles;\n      let first = rects[0];\n      let last = rects[rects.length - 1];\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\n        first.x, first.y, annotation.page, true\n      );\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\n        last.x + last.width, last.y, annotation.page, false\n      );\n      break;\n\n    case 'textbox':\n    case 'point':\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\n        annotation.x, annotation.y, annotation.page\n      );\n      break;\n\n    case 'drawing':\n    case 'area':\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x, y, annotation.page\n      );\n      break;\n  }\n\n  // Include comments in screen reader hint\n  if (COMMENT_TYPES.includes(annotation.type)) {\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertScreenReaderHint.js\n **/","/**\n * Create a node that is only visible to screen readers\n *\n * @param {String} content The text content that should be read by screen reader\n * @param {String} [annotationId] The ID of the annotation assocaited\n * @return {Element} An Element that is only visible to screen readers\n */\nexport default function createScreenReaderOnly(content, annotationId) {\n  let node = document.createElement('div');\n  let text = document.createTextNode(content);\n  node.appendChild(text);\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\n  node.style.position = 'absolute';\n  node.style.left = '-10000px';\n  node.style.top = 'auto';\n  node.style.width = '1px';\n  node.style.height = '1px';\n  node.style.overflow = 'hidden';\n  return node;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/createScreenReaderOnly.js\n **/","import insertElementWithinElement from './insertElementWithinElement';\nimport { pointIntersectsRect } from '../UI/utils';\nimport { scaleUp } from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will try to insert between elements if possible.\n * It will however use `insertElementWithinElement` if it is more accurate.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\n  // Try and use most accurate method of inserting within an element\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\n    return true;\n  }\n\n  // Fall back to inserting between elements\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  let nodes = [...svg.parentNode.querySelectorAll('.textLayer > div')];\n\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n\n  // Find the best node to insert before\n  for (let i=0, l=nodes.length; i<l; i++) {\n    let n = nodes[i];\n    let r = n.getBoundingClientRect();\n    if (y <= r.top) {\n      n.parentNode.insertBefore(el, n);\n      return true;\n    }\n  }\n\n  // If all else fails try to append to the bottom\n  let textLayer = svg.parentNode.querySelector('.textLayer');\n  if (textLayer) {\n    let textRect = textLayer.getBoundingClientRect();\n    if (pointIntersectsRect(x, y, textRect)) {\n      textLayer.appendChild(el);\n      return true;\n    }\n  }\n\n  return false;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertElementWithinChildren.js\n **/","import {\n  pointIntersectsRect,\n  scaleUp,\n  scaleDown\n} from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will only insert within an element amidst it's text content.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n  const OFFSET_ADJUST = 2;\n\n  // If inserting before adjust `x` by looking for element a few px to the right\n  // Otherwise adjust a few px to the left\n  // This is to allow a little tolerance by searching within the box, instead\n  // of getting a false negative by testing right on the border.\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\n\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n  if (!node) {\n    return false;\n  }\n  \n  // Now that node has been found inverse the adjustment for `x`.\n  // This is done to accomodate tolerance by cutting off on the outside of the\n  // text boundary, instead of missing a character by cutting off within.\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\n\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\n  let temp = node.cloneNode(true);\n  let head = temp.innerHTML.split('');\n  let tail = [];\n\n  // Insert temp off screen\n  temp.style.position = 'absolute';\n  temp.style.top = '-10000px';\n  temp.style.left = '-10000px';\n  document.body.appendChild(temp);\n\n  while (head.length) {\n    // Don't insert within HTML tags\n    if (head[head.length - 1] === '>') {\n      while(head.length) {\n        tail.unshift(head.pop());\n        if (tail[0] === '<') {\n          break;\n        }\n      }\n    }\n    \n    // Check if width of temp based on current head value satisfies x\n    temp.innerHTML = head.join('');\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\n    if (left + width <= x) {\n      break;\n    }\n    tail.unshift(head.pop());\n  }\n  \n  // Update original node with new markup, including element to be inserted\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\n  temp.parentNode.removeChild(temp);\n\n  return true;\n}\n\n/**\n * Get a text layer element at a given point on a page\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page to limit elements to\n * @return {Element} First text layer element found at the point\n */\nfunction textLayerElementFromPoint(x, y, pageNumber) {\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n  return [...svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]')].filter((el) => {\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\n  })[0];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertElementWithinElement.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport insertScreenReaderComment from './insertScreenReaderComment';\n\n/**\n * Insert the comments into the DOM to be available by screen reader\n *\n * Example output:\n *   <div class=\"screenReaderOnly\">\n *    <div>Begin highlight 1</div>\n *    <ol aria-label=\"Comments\">\n *      <li>Foo</li>\n *      <li>Bar</li>\n *      <li>Baz</li>\n *      <li>Qux</li>\n *    </ol>\n *  </div>\n *  <div>Some highlighted text goes here...</div>\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\n *\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of the annotation\n * @param {Array} [comments] Optionally preloaded comments to be rendered\n * @return {Promise}\n */\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\n  let promise;\n\n  if (Array.isArray(comments)) {\n    promise = Promise.resolve(comments);\n  } else {\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\n  }\n\n  return promise.then((comments) => {\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\n    if (node) { \n      let list = document.createElement('ol');\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\n      list.setAttribute('aria-label', 'Comments');\n      node.appendChild(list);\n      comments.forEach(insertScreenReaderComment);\n    }\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/renderScreenReaderComments.js\n **/","/**\n * Insert a comment into the DOM to be available by screen reader\n *\n * @param {Object} comment The comment to be inserted\n */\nexport default function insertScreenReaderComment(comment) {\n  if (!comment) {\n    return;\n  }\n\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\n  if (list) {\n    let item = document.createElement('li');\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\n    item.appendChild(document.createTextNode(`${comment.content}`));\n    list.appendChild(item);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertScreenReaderComment.js\n **/","import insertScreenReaderHint from './insertScreenReaderHint';\nimport renderScreenReaderHints from './renderScreenReaderHints';\nimport insertScreenReaderComment from './insertScreenReaderComment';\nimport renderScreenReaderComments from './renderScreenReaderComments';\nimport { addEventListener } from '../UI/event';\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\n/**\n * Initialize the event handlers for keeping screen reader hints synced with data\n */\nexport default function initEventHandlers() {\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\n  });\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\n  });\n  addEventListener('annotation:delete', removeAnnotation);\n  addEventListener('comment:add', insertComment);\n  addEventListener('comment:delete', removeComment);\n}\n\n/**\n * Reorder the annotation numbers by annotation type\n *\n * @param {String} documentId The ID of the document\n * @param {Number} pageNumber The page number of the annotations\n * @param {Strig} type The annotation type\n */\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\n    .then((annotations) => {\n      return annotations.annotations.filter((a) => {\n        return a.type === type;\n      });\n    })\n    .then((annotations) => {\n      annotations.forEach((a) => {\n        removeAnnotation(documentId, a.uuid);\n      });\n\n      return annotations;\n    })\n    .then(renderScreenReaderHints);\n}\n\n/**\n * Remove the screen reader hint for an annotation\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The Id of the annotation\n */\nfunction removeAnnotation(documentId, annotationId) {\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\n}\n\n/**\n * Insert a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of tha assocated annotation\n * @param {Object} comment The comment to insert a hint for\n */\nfunction insertComment(documentId, annotationId, comment) {\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n  let promise;\n\n  if (!list) {\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n      return true;\n    });\n  } else {\n    promise = Promise.resolve(true);\n  }\n\n  promise.then(() => {\n    insertScreenReaderComment(comment);\n  });\n}\n\n/**\n * Remove a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} commentId The ID of the comment\n */\nfunction removeComment(documentId, commentId) {\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\n}\n\n/**\n * Remove an element from the DOM by it's ID if it exists\n *\n * @param {String} elementID The ID of the element to be removed\n */\nfunction removeElementById(elementId) {\n  let el = document.getElementById(elementId);\n  if (el) {\n    el.parentNode.removeChild(el);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/initEventHandlers.js\n **/","import { addEventListener, removeEventListener, fireEvent } from './event';\nimport { disableEdit, enableEdit } from './edit';\nimport { disablePen, enablePen, setPen } from './pen';\nimport { disablePoint, enablePoint } from './point';\nimport { disableRect, enableRect } from './rect';\nimport { disableText, enableText, setText } from './text';\nimport { createPage, renderPage } from './page';\n\nexport default {\n  addEventListener, removeEventListener, fireEvent,\n  disableEdit, enableEdit,\n  disablePen, enablePen, setPen,\n  disablePoint, enablePoint,\n  disableRect, enableRect,\n  disableText, enableText, setText,\n  createPage, renderPage\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/index.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\n\nimport appendChild from '../render/appendChild';\nimport {\n  addEventListener,\n  removeEventListener\n} from './event';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGContainer,\n  findSVGAtPoint,\n  getAnnotationRect,\n  getMetadata,\n  scaleDown,\n  scaleUp\n} from './utils';\n\nlet _enabled = false;\nlet isDragging = false, overlay;\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\nconst OVERLAY_BORDER_SIZE = 3;\n\n/**\n * Create an overlay for editing an annotation.\n *\n * @param {Element} target The annotation element to apply overlay for\n */\nfunction createEditOverlay(target) {\n  destroyEditOverlay();\n\n  overlay = document.createElement('div');\n  let anchor = document.createElement('a');\n  let parentNode = findSVGContainer(target).parentNode;\n  let id = target.getAttribute('data-pdf-annotate-id');\n  let rect = getAnnotationRect(target);\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\n  \n  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n  overlay.setAttribute('data-target-id', id);\n  overlay.style.boxSizing = 'content-box';\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${styleTop}px`;\n  overlay.style.left = `${styleLeft}px`;\n  overlay.style.width = `${rect.width}px`;\n  overlay.style.height = `${rect.height}px`;\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\n  overlay.style.cursor = 'pointer';\n\n  anchor.innerHTML = '';\n  anchor.setAttribute('href', 'javascript://');\n  anchor.style.background = '#fff';\n  anchor.style.borderRadius = '20px';\n  anchor.style.border = '1px solid #bbb';\n  anchor.style.color = '#bbb';\n  anchor.style.fontSize = '16px';\n  anchor.style.padding = '2px';\n  anchor.style.textAlign = 'center';\n  anchor.style.textDecoration = 'none';\n  anchor.style.position = 'absolute';\n  anchor.style.top = '-13px';\n  anchor.style.right = '-13px';\n  anchor.style.width = '25px';\n  anchor.style.height = '25px';\n  \n  overlay.appendChild(anchor);\n  parentNode.appendChild(overlay);\n  document.addEventListener('click', handleDocumentClick);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  anchor.addEventListener('click', deleteAnnotation);\n  anchor.addEventListener('mouseover', () => {\n    anchor.style.color = '#35A4DC';\n    anchor.style.borderColor = '#999';\n    anchor.style.boxShadow = '0 1px 1px #ccc';\n  });\n  anchor.addEventListener('mouseout', () => {\n    anchor.style.color = '#bbb';\n    anchor.style.borderColor = '#bbb';\n    anchor.style.boxShadow = '';\n  });\n  overlay.addEventListener('mouseover', () => {\n    if (!isDragging) { anchor.style.display = ''; }\n  });\n  overlay.addEventListener('mouseout', () => {\n    anchor.style.display = 'none';\n  });\n}\n\n/**\n * Destroy the edit overlay if it exists.\n */\nfunction destroyEditOverlay() {\n  if (overlay) {\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n  }\n\n  document.removeEventListener('click', handleDocumentClick);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Delete currently selected annotation\n */\nfunction deleteAnnotation() {\n  if (!overlay) { return; }\n\n  let annotationId = overlay.getAttribute('data-target-id');\n  let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let { documentId } = getMetadata(svg);\n\n  [...nodes].forEach((n) => {\n    n.parentNode.removeChild(n);\n  });\n  \n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\n\n  destroyEditOverlay();\n}\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  // Remove current overlay\n  let overlay = document.getElementById('pdf-annotate-edit-overlay');\n  if (overlay) {\n    if (isDragging) {\n      return;\n    }\n\n    destroyEditOverlay();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentKeyup(e) {\n  if (overlay && e.keyCode === 46 &&\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\n      e.target.nodeName.toLowerCase() !== 'input') {\n    deleteAnnotation();\n  }\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousedown(e) {\n  if (e.target !== overlay) { return; }\n\n  // Highlight and strikeout annotations are bound to text within the document.\n  // It doesn't make sense to allow repositioning these types of annotations.\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target.getAttribute('data-pdf-annotate-type');\n\n  if (type === 'highlight' || type === 'strikeout') { return; }\n\n  isDragging = true;\n  dragOffsetX = e.clientX;\n  dragOffsetY = e.clientY;\n  dragStartX = overlay.offsetLeft;\n  dragStartY = overlay.offsetTop;\n\n  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\n  overlay.style.cursor = 'move';\n  overlay.querySelector('a').style.display = 'none';\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let parentNode = overlay.parentNode;\n  let rect = parentNode.getBoundingClientRect();\n  let y = (dragStartY + (e.clientY - dragOffsetY));\n  let x = (dragStartX + (e.clientX - dragOffsetX));\n  let minY = 0;\n  let maxY = rect.height;\n  let minX = 0;\n  let maxX = rect.width;\n\n  if (y > minY && y + overlay.offsetHeight < maxY) {\n    overlay.style.top = `${y}px`;\n  }\n\n  if (x > minX && x + overlay.offsetWidth < maxX) {\n    overlay.style.left = `${x}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target[0].getAttribute('data-pdf-annotate-type');\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let { documentId } = getMetadata(svg);\n  \n  overlay.querySelector('a').style.display = '';\n\n  function getDelta(propX, propY) {\n    return calcDelta(parseInt(target[0].getAttribute(propX), 10), parseInt(target[0].getAttribute(propY), 10));\n  }\n\n  function calcDelta(x, y) {\n    return {\n      deltaX: OVERLAY_BORDER_SIZE + scaleDown(svg, {x: overlay.offsetLeft}).x - x,\n      deltaY: OVERLAY_BORDER_SIZE + scaleDown(svg, {y: overlay.offsetTop}).y - y\n    };\n  }\n\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    if (['area', 'highlight', 'point', 'textbox'].indexOf(type) > -1) {\n      let { deltaX, deltaY } = getDelta('x', 'y');\n      [...target].forEach((t, i) => {\n        if (deltaY !== 0) {\n          let modelY = parseInt(t.getAttribute('y'), 10) + deltaY;\n          let viewY = modelY;\n\n          if (type === 'textbox') {\n            viewY += annotation.size;\n          }\n\n          if (type === 'point') {\n            viewY = scaleUp(svg, { viewY }).viewY;\n          }\n\n          t.setAttribute('y', viewY);\n          if (annotation.rectangles) {\n            annotation.rectangles[i].y = modelY;\n          } else if (annotation.y) {\n            annotation.y = modelY;\n          }\n        }\n        if (deltaX !== 0) {\n          let modelX = parseInt(t.getAttribute('x'), 10) + deltaX;\n          let viewX = modelX;\n\n          if (type === 'point') {\n            viewX = scaleUp(svg, { viewX }).viewX;\n          }\n\n          t.setAttribute('x', viewX);\n          if (annotation.rectangles) {\n            annotation.rectangles[i].x = modelX;\n          } else if (annotation.x) {\n            annotation.x = modelX;\n          }\n        }\n      });\n    // } else if (type === 'strikeout') {\n    //   let { deltaX, deltaY } = getDelta('x1', 'y1');\n    //   [...target].forEach(target, (t, i) => {\n    //     if (deltaY !== 0) {\n    //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n    //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n    //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n    //     }\n    //     if (deltaX !== 0) {\n    //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n    //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n    //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n    //     }\n    //   });\n    } else if (type === 'drawing') {\n      let rect = scaleDown(svg, getAnnotationRect(target[0]));\n      let [originX, originY] = annotation.lines[0];\n      let { deltaX, deltaY } = calcDelta(originX, originY);\n\n      // origin isn't necessarily at 0/0 in relation to overlay x/y\n      // adjust the difference between overlay and drawing coords\n      deltaY += (originY - rect.top);\n      deltaX += (originX - rect.left);\n\n      annotation.lines.forEach((line, i) => {\n        let [x, y] = annotation.lines[i];\n        annotation.lines[i][0] = x + deltaX;\n        annotation.lines[i][1] = y + deltaY;\n      });\n\n      target[0].parentNode.removeChild(target[0]);\n      appendChild(svg, annotation);\n    }\n\n    PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n  });\n\n  // Why tho\n  // setTimeout(function () {\n  //   isDragging = false;\n  // }, 0);\n  isDragging = false;\n\n  overlay.style.background = '';\n  overlay.style.cursor = '';\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Handle annotation.click event\n *\n * @param {Element} e The annotation element that was clicked\n */\nfunction handleAnnotationClick(target) {\n  createEditOverlay(target);\n}\n\n/**\n * Enable edit mode behavior.\n */\nexport function enableEdit () {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  addEventListener('annotation:click', handleAnnotationClick);\n  document.getElementsByClassName('textLayer')[0].style.pointerEvents = \"none\";\n};\n\n/**\n * Disable edit mode behavior.\n */\nexport function disableEdit () {\n  destroyEditOverlay();\n\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  removeEventListener('annotation:click', handleAnnotationClick);\n  document.getElementsByClassName('textLayer')[0].style.pointerEvents = \"\";\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/edit.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines;\n\n/**\n * Handle document.mousedown event\n */\nfunction handleDocumentMousedown() {\n  path = null;\n  lines = [];\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n        type: 'drawing',\n        width: _penSize,\n        color: _penColor,\n        lines\n      }\n    ).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousemove(e) {\n  savePoint(e.clientX, e.clientY);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    document.removeEventListener('mouseup', handleDocumentMouseup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = scaleDown(svg, {\n    x: x - rect.left,\n    y: y - rect.top\n  });\n\n  lines.push([point.x, point.y]);\n\n  if (lines.length <= 1) {\n    return;\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'drawing',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setPen(penSize = 1, penColor = '000000') {\n  _penSize = parseInt(penSize, 10);\n  _penColor = penColor;\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enablePen() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disablePen() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/pen.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return\n  }\n  \n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-point-input');\n  input.setAttribute('placeholder', 'Enter comment');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  savePoint();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  } else if (e.keyCode === 13) {\n    savePoint();\n  }\n}\n\n/**\n * Save a new point annotation from input\n */\nfunction savePoint() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let content = input.value.trim();\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let rect = svg.getBoundingClientRect();\n    let { documentId, pageNumber } = getMetadata(svg);\n    let annotation = Object.assign({\n        type: 'point'\n      }, scaleDown(svg, {\n        x: clientX - rect.left,\n        y: clientY - rect.top\n      })\n    );\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        PDFJSAnnotate.getStoreAdapter().addComment(\n          documentId,\n          annotation.uuid,\n          content\n        );\n\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input element\n */\nfunction closeInput() {\n  input.removeEventListener('blur', handleInputBlur);\n  input.removeEventListener('keyup', handleInputKeyup);\n  document.body.removeChild(input);\n  input = null;\n}\n\n/**\n * Enable point annotation behavior\n */\nexport function enablePoint() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable point annotation behavior\n */\nexport function disablePoint() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/point.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  getOffset,\n  scaleDown,\n  scaleUp\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\n\n/**\n * Clear text selection\n */\nfunction clearSelection() {\n  if (window.getSelection) {\n    if (window.getSelection().removeAllRanges) {\n      window.getSelection().removeAllRanges();\n      window.getSelection().addRange(document.createRange());\n    } else if (window.getSelection().empty) {\n      window.getSelection().empty();\n    }\n  }\n}\n\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n  try {\n    let selection = window.getSelection();\n    let range = selection.getRangeAt(0);\n    let rects = range.getClientRects();\n\n    if (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n      clearSelection();\n      return rects;\n    }\n  } catch (e) {}\n  \n  return null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n  let svg;\n  if (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  originY = e.clientY;\n  originX = e.clientX;\n\n  overlay = document.createElement('div');\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${originY - rect.top}px`;\n  overlay.style.left = `${originX - rect.left}px`;\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = '3px';\n  svg.parentNode.appendChild(overlay);\n  \n  document.addEventListener('mousemove', handleDocumentMousemove);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let rect = svg.getBoundingClientRect();\n\n  if (originX + (e.clientX - originX) < rect.right) {\n    overlay.style.width = `${e.clientX - originX}px`;\n  }\n\n  if (originY + (e.clientY - originY) < rect.bottom) {\n    overlay.style.height = `${e.clientY - originY}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let rects;\n  if (_type !== 'area' && (rects = getSelectionRects())) {\n    let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n    saveRect(_type, [...rects].map((r) => {\n      return {\n        top: r.top,\n        left: r.left,\n        width: r.width,\n        height: r.height\n      };\n    }));\n  } else if (_type === 'area' && overlay) {\n    let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n    let rect = svg.getBoundingClientRect();\n    saveRect(_type, [{\n      top: parseInt(overlay.style.top, 10) + rect.top,\n      left: parseInt(overlay.style.left, 10) + rect.left,\n      width: parseInt(overlay.style.width, 10),\n      height: parseInt(overlay.style.height, 10)\n    }]);\n\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    enableUserSelect();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    let selection = window.getSelection();\n    selection.removeAllRanges();\n    if (overlay && overlay.parentNode) {\n      overlay.parentNode.removeChild(overlay);\n      overlay = null;\n      document.removeEventListener('mousemove', handleDocumentMousemove);\n    }\n  }\n}\n\n/**\n * Save a rect annotation\n *\n * @param {String} type The type of rect (area, highlight, strikeout)\n * @param {Array} rects The rects to use for annotation\n * @param {String} color The color of the rects\n */\nfunction saveRect(type, rects, color) {\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n  let node;\n  let annotation;\n\n  if (!svg) {\n    return;\n  }\n\n  let boundingRect = svg.getBoundingClientRect();\n\n  if (!color) {\n    if (type === 'highlight') {\n      color = 'FFFF00';\n    } else if (type === 'strikeout') {\n      color = 'FF0000';\n    } else if (type === 'area') {\n      color = '0000FF';\n    }\n  }\n\n  // Initialize the annotation\n  annotation = {\n    type,\n    color,\n    rectangles: [...rects].map((r) => {\n      let offset = 0;\n\n      if (type === 'strikeout') {\n        offset = r.height / 2;\n      }\n\n      return scaleDown(svg, {\n        y: (r.top + offset) - boundingRect.top,\n        x: r.left - boundingRect.left,\n        width: r.width,\n        height: r.height\n      });\n    }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n  };\n  \n  // Short circuit if no rectangles exist\n  if (annotation.rectangles.length === 0) {\n    return;\n  }\n\n  // Special treatment for area as it only supports a single rect\n  if (type === 'area') {\n    let rect = annotation.rectangles[0];\n    delete annotation.rectangles;\n    annotation.x = rect.x;\n    annotation.y = rect.y;\n    annotation.width = rect.width;\n    annotation.height = rect.height;\n  }\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable rect behavior\n */\nexport function enableRect(type) {\n  _type = type;\n  \n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n}\n\n/**\n * Disable rect behavior\n */\nexport function disableRect() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/rect.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\nlet _textSize;\nlet _textColor;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-text-input');\n  input.setAttribute('placeholder', 'Enter text');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n  input.style.fontSize = `${_textSize}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  saveText();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  } else if (e.keyCode === 13) {\n    saveText();\n  }\n}\n\n/**\n * Save a text annotation from input\n */\nfunction saveText() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let { documentId, pageNumber } = getMetadata(svg);\n    let rect = svg.getBoundingClientRect();\n    let annotation = Object.assign({\n        type: 'textbox',\n        size: _textSize,\n        color: _textColor,\n        content: input.value.trim()\n      }, scaleDown(svg, {\n        x: clientX - rect.left,\n        y: clientY -  rect.top,\n        width: input.offsetWidth,\n        height: input.offsetHeight\n      })\n    );\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        appendChild(svg, annotation);\n      });\n  }\n  \n  closeInput();\n}\n\n/**\n * Close the input\n */\nfunction closeInput() {\n  if (input) {\n    input.removeEventListener('blur', handleInputBlur);\n    input.removeEventListener('keyup', handleInputKeyup);\n    document.body.removeChild(input);\n    input = null;\n  }\n}\n\n/**\n * Set the text attributes\n *\n * @param {Number} textSize The size of the text\n * @param {String} textColor The color of the text\n */\nexport function setText(textSize = 12, textColor = '000000') {\n  _textSize = parseInt(textSize, 10);\n  _textColor = textColor;\n}\n\n\n/**\n * Enable text behavior\n */\nexport function enableText() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n/**\n * Disable text behavior\n */\nexport function disableText() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/text.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n// Template for creating a new page\nconst PAGE_TEMPLATE = `\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\n    <div class=\"canvasWrapper\">\n      <canvas></canvas>\n    </div>\n    <svg class=\"annotationLayer\"></svg>\n    <div class=\"textLayer\"></div>\n  </div>\n`;\n\n/**\n * Create a new page to be appended to the DOM.\n *\n * @param {Number} pageNumber The page number that is being created\n * @return {HTMLElement}\n */\nexport function createPage(pageNumber) {\n  let temp = document.createElement('div');\n  temp.innerHTML = PAGE_TEMPLATE;\n\n  let page = temp.children[0];\n  let canvas = page.querySelector('canvas');\n\n  page.setAttribute('id', `pageContainer${pageNumber}`);\n  page.setAttribute('data-page-number', pageNumber);\n\n  canvas.mozOpaque = true;\n  canvas.setAttribute('id', `page${pageNumber}`);\n\n  return page;\n}\n\n/**\n * Render a page that has already been created.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport function renderPage(pageNumber, renderOptions) {\n  let {\n    documentId,\n    pdfDocument,\n    scale,\n    rotate\n  } = renderOptions;\n\n  // Load the page and annotations\n  return Promise.all([\n    pdfDocument.getPage(pageNumber),\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber)\n  ]).then(([pdfPage, annotations]) => {\n    let page = document.getElementById(`pageContainer${pageNumber}`);\n    let svg = page.querySelector('.annotationLayer');\n    let canvas = page.querySelector('.canvasWrapper canvas');\n    let canvasContext = canvas.getContext('2d', {alpha: false});\n    let viewport = pdfPage.getViewport(scale, rotate);\n    let transform = scalePage(pageNumber, viewport, canvasContext);\n\n    // Render the page\n    return Promise.all([\n      pdfPage.render({ canvasContext, viewport, transform }),\n      PDFJSAnnotate.render(svg, viewport, annotations)\n    ]).then(() => {\n      // Text content is needed for a11y, but is also necessary for creating\n      // highlight and strikeout annotations which require selecting text.\n      return pdfPage.getTextContent({normalizeWhitespace: true}).then((textContent) => {\n        return new Promise((resolve, reject) => {\n          // Render text layer for a11y of text content\n          let textLayer = page.querySelector(`.textLayer`);\n          let textLayerFactory = new PDFJS.DefaultTextLayerFactory();\n          let textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber -1, viewport);\n          textLayerBuilder.setTextContent(textContent);\n          textLayerBuilder.render();\n\n          // Enable a11y for annotations\n          // Timeout is needed to wait for `textLayerBuilder.render`\n          setTimeout(() => {\n            try {\n              renderScreenReaderHints(annotations.annotations);\n              resolve();\n            } catch (e) {\n              reject(e);\n            }\n          });\n        });\n      });\n    }).then(() => {\n      // Indicate that the page was loaded\n      page.setAttribute('data-loaded', 'true');\n\n      return [pdfPage, annotations];\n    });\n  });\n}\n\n/**\n * Scale the elements of a page.\n *\n * @param {Number} pageNumber The page number to be scaled\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n * @param {Object} context The canvas context that the PDF page is rendered to\n * @return {Array} The transform data for rendering the PDF page\n */\nfunction scalePage(pageNumber, viewport, context) {\n  let page = document.getElementById(`pageContainer${pageNumber}`);\n  let canvas = page.querySelector('.canvasWrapper canvas');\n  let svg = page.querySelector('.annotationLayer');\n  let wrapper = page.querySelector('.canvasWrapper');\n  let textLayer = page.querySelector('.textLayer');\n  let outputScale = getOutputScale(context);\n  let transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n  let sfx = approximateFraction(outputScale.sx);\n  let sfy = approximateFraction(outputScale.sy);\n\n  // Adjust width/height for scale\n  page.style.visibility = '';\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\n  svg.setAttribute('width', viewport.width);\n  svg.setAttribute('height', viewport.height);\n  svg.style.width = `${viewport.width}px`;\n  svg.style.height = `${viewport.height}px`;\n  page.style.width = `${viewport.width}px`;\n  page.style.height = `${viewport.height}px`;\n  wrapper.style.width = `${viewport.width}px`;\n  wrapper.style.height = `${viewport.height}px`;\n  textLayer.style.width = `${viewport.width}px`;\n  textLayer.style.height = `${viewport.height}px`;\n\n  return transform;\n}\n\n/**\n * The following methods are taken from mozilla/pdf.js and as such fall under\n * the Apache License (http://www.apache.org/licenses/).\n *\n * Original source can be found at mozilla/pdf.js:\n * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\n */\n\n/**\n * Approximates a float number as a fraction using Farey sequence (max order\n * of 8).\n *\n * @param {Number} x Positive float number\n * @return {Array} Estimated fraction: the first array item is a numerator,\n *                 the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast path for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n\n  const xinv = 1 / x;\n  const limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  const x_ = x > 1 ? xinv : x;\n  \n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0, b = 1, c = 1, d = 1;\n  \n  // Limit search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c, q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    } else {\n      a = p; b = q;\n    }\n  }\n\n  // Select closest of neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    return x_ === x ? [a, b] : [b, a];\n  } else {\n    return x_ === x ? [c, d] : [d, c];\n  }\n}\n\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1\n  };\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/page.js\n **/"],"sourceRoot":""}